## MITSUI & CO. Commodity Prediction Challenge：コンペティション

データサイエンスの世界的プラットフォームKaggle上で開催されている「MITSUI & CO. Commodity Prediction Challenge」。本稿では、このコンペティションの目的からルール、提供データ、評価基準に至るまで、参加を検討している、あるいは既に参加しているすべてのデータサイエンティストが知るべき情報を、公式ドキュメントに基づき、日本語で網羅的かつ詳細に解説します。

### 第1章：コンペティションの概要 (Overview)

本章では、コンペティションの根幹をなす目的、挑戦課題、そしてその背景にある社会的・経済的な重要性について深く掘り下げます。

#### 1.1. 主催者と究極の目的

*   **主催者:** 三井物産株式会社 (MITSUI & CO., LTD.)
*   **究極の目的:** コモディティ（商品）価格の**より正確で、かつ安定した長期予測モデル**を開発すること。

本コンペティションは、単なる予測精度の高さを競うだけでなく、変動の激しいグローバルなコモディティ市場において、安定的かつ持続的に機能する予測技術の確立を目指しています。

#### 1.2. 挑戦課題：価格変動の本質を捉える「価格差系列」の予測

参加者に課される中心的な課題は、ロンドン金属取引所（LME）、日本取引所グループ（JPX）、米国株式市場、そして外国為替（FX）市場から得られる膨大かつ多様な過去の時系列データを駆使して、**将来のコモディティリターンを高精度で予測するモデルを構築すること**です。

特に、本コンペティションが特徴的なのは、参加者に**「価格差系列（price-difference series）」**の予測を求めている点です。これは、2つの異なる金融資産の価格差から計算される時系列データであり、個々の資産の価格変動に含まれるノイズを相殺し、より本質的で安定した価格変動のシグナル（特徴量）を抽出することを意図しています。

このシグナルを正確に捉えることで、AI駆動型の高度な取引技術を開発し、最終的には持続可能な取引利益を生み出すことが、この挑戦の先にある目標です。

#### 1.3. 社会的・経済的重要性：なぜ「今」、この課題なのか

正確なコモディティ価格の予測は、一企業の利益を超え、世界経済全体の安定にとって極めて重要です。

*   **現状の課題:**
    *   **非効率な意思決定:** 不正確な価格予測は、企業を非効率な取引戦略や誤った投資判断に導き、結果として大きな経済的損失や機会損失を招きます。
    *   **市場の不安定化:** 予測の不確実性は、価格の乱高下を助長し、生産者、消費者、投資家といった市場に関わるすべてのステークホルダーに悪影響を及ぼします。企業の資源配分、予算策定、投資計画にも困難をもたらします。

*   **コンペが目指す未来:**
    この課題を解決し、高精度な予測モデルが実現されれば、以下のような好循環が期待できます。
    *   企業は、より効果的な取引戦略を立案し、情報に基づいた賢明な投資判断を下せるようになります。
    *   金融リスクをより効果的に管理・低減できます。
    *   資源配分が効率化され、価格変動が抑制されることで、より安定的で予測可能なグローバル・コモディティ市場が実現します。

#### 1.4. 技術的背景と本コンペへの期待

現在、コモディティ市場の予測には、既に高度なAIアルゴリズムや高精度モデルが活用されています。しかし、これらの既存モデルには依然として限界が存在します。

*   **既存モデルの限界:**
    *   特定のデータパターンへの過度な依存（過学習）。
    *   多様な市場環境や、刻一刻と変化する金融市場のダイナミズムへの適応力不足。
    *   結果として、長期にわたる安定した高精度予測の実現には至っていません。

本コンペティションは、世界中の才能あるデータサイエンティストの知見を結集することで、これまでとは異なるアプローチや、より多様で堅牢（ロバスト）なアルゴリズム群の創出を促し、**信頼性と安定性の高い長期予測**という目標を達成ことを目指しています。

#### 1.5. 謝辞

本コンペティションの実現にあたり、以下の企業が技術的な支援を行っています。
*   **問題設計・データ作成の技術サポート:** AlpacaTech株式会社
*   **外国為替データの提供:** APILayer社のExchange Rates API

### 第2章：評価と提出方法

モデルの性能をどのように測定し、どのように提出するのか。コンペティションの根幹をなす評価指標と提出要件を解説します。

#### 2.1. 評価指標 (Evaluation)

本コンペティションでは、金融の世界で広く用いられる**シャープレシオの変種**が評価指標として採用されています。具体的な計算式は以下の通りです。

**評価スコア = 平均（スピアマン順位相関係数） / 標準偏差（スピアマン順位相関係数）**

*   **スピアマン順位相関係数:** モデルによる予測値と、実際のターゲット値（正解ラベル）の間の順位の相関を測る指標です。-1から+1の値をとり、+1に近いほど予測の順位と実際の順位が一致していることを意味します。これにより、予測値の絶対的な大きさよりも、大小関係の正しさが評価されます。
*   **指標の意図:** この指標は、単に予測の**正確性**（分子の平均相関係数）を最大化するだけでなく、予測パフォーマンスの**安定性**（分母の標準偏差を小さくすること）も同時に評価することを目的としています。予測スコアが日によって大きく変動する不安定なモデルよりも、継続して安定したパフォーマンスを発揮するモデルが高く評価される設計になっています。

#### 2.2. 提出方法 (Submission)

提出は、公平性と再現性を担保するため、厳格なルールのもとで行われます。

*   **提出プラットフォーム:** すべての提出は、**Kaggle Notebooks**環境を介して行う必要があります。
*   **専用評価APIの利用:** 本コンペティションは時系列予測であり、未来のデータを使った学習（リーク）を防ぐため、提供された**専用の評価API**を通じて提出することが義務付けられています。参加者のノートブックは、このAPIを呼び出すことでテストデータを受け取り、予測結果を返す仕組みです。これにより、主催者側で管理された未知のデータに対する評価が可能となります。

### 第3章：スケジュールと賞金

コンペティションの期間と、成功者へ贈られるインセンティブについて説明します。

#### 3.1. タイムライン (Timeline)

本コンペティションは、モデルの学習を行う「トレーニングフェーズ」と、未知の市場データで真価が問われる「予測フェーズ」の2段階で進行します。

*   **トレーニングフェーズ (Training Phase):**
    *   **開始日:** 2025年7月24日
    *   **参加登録締切:** 2025年9月29日
    *   **チーム合併締切:** 2025年9月29日
    *   **最終提出締切:** 2025年10月6日

*   **予測フェーズ (Forecasting Phase):**
    *   **期間:** 最終提出締切後からコンペティション終了日まで。
    *   **内容:** 最終提出締切後に収集される実際の市場データを用いて、参加者が提出したノートブックが定期的に実行され、プライベートリーダーボードが更新されます。
    *   **コンペティション終了日:** 2026年1月16日

*   **注意点:** 全ての締切は、特に記載がない限り、該当日の**協定世界時(UTC) 23:59**です。日本時間（JST）とは9時間の時差があるため、注意が必要です。

#### 3.2. 賞金 (Prizes)

賞金総額は **$100,000 USD** です。順位に応じた内訳は以下の通りです。

*   **1位:** $20,000
*   **2位:** $10,000
*   **3位:** $10,000
*   **4位 - 15位:** 各$5,000

### 第4章：提供データ (Data)

モデル構築の基盤となるデータセットの詳細です。

#### 4.1. データセット概要

本コンペティションでは、世界中の金融市場から収集された複数の時系列データが提供されます。データには、金属、先物、米国株式、外国為替など、様々な金融商品に関する情報が含まれています。

#### 4.2. ファイル詳細

*   `train.csv`: モデルの学習に使用する、過去の金融データです。終値、取引量、為替レートなどが含まれます。各データは `date_id`（UTC基準の日付）と、取引所（LME, JPX, US, FX）を示す接頭辞付きの時系列IDで識別されます。
*   `test.csv`: 最終評価に使われる、未公開のテストセットの構造を模したファイルです。評価APIから実際に渡されるデータもこの形式に従います。
*   `train_labels.csv`: 学習データに対応するターゲット（正解ラベル）データです。ターゲットは、単一金融商品の対数リターン、または二つの金融商品のリターンの差分から構成されます。
*   `target_pairs.csv`: `train_labels.csv`に含まれる各ターゲット（`target_[0-423]`）が、どの金融商品の組み合わせから、何日のラグ（遅延）で計算されているかの詳細情報が記載されています。このファイルを用いることで、`train.csv`の価格データからターゲットを再現計算することが可能です。
*   `lagged_test_labels/`: 評価APIから提供される、ラグ（遅延）付きの正解ラベルデータです。`test_labels_lag_[1-4].csv`のように、ラグ日数ごとにファイルが分かれています。
*   `kaggle_evaluation/`: 評価APIの動作に使用されるファイル群です。

#### 4.3. コンペティションのフェーズとデータ利用上の注意点

*   **トレーニングフェーズ:**
    *   この期間中、公開リーダーボードのスコアリングに使用されるテストセットは、`train.csv`の最後の約90日分のデータです。
    *   これらの価格データは**既に公開されている情報**であるため、この期間中の公開リーダーボードのスコアは、モデルの真の性能を反映しておらず、最終的な評価において**全く意味を持ちません**。参加者はこのスコアに惑わされることなく、堅牢な検証戦略を構築する必要があります。

*   **予測フェーズ:**
    *   最終提出締切後に収集される、**完全に新しい期間のデータ**が、プライベートリーダーボードのスコアリングに使用される本当のテストセットとなります。
    *   このテストセットのデータサイズは、トレーニングフェーズのテストセット（約90日分）と同程度になる見込みです。
    *   評価APIは、公開テストセットの開始日からプライベートテストセットの終了日まで、一貫してデータを提供します。

### 第5章：コンペティションルール (Rules)

本章では、参加者が遵守すべき重要なルールを詳細に解説します。ルール違反は失格につながる可能性があるため、熟読が不可欠です。

#### 5.1. 主要な参加資格 (Eligibility)

*   Kaggleの登録ユーザーであり、18歳以上（または居住地域の成人年齢以上）である必要があります。
*   以下の国・地域に居住する個人は参加できません：**クリミア、いわゆる「ドネツク人民共和国(DNR)」、いわゆる「ルガンスク人民共和国(LNR)」、キューバ、イラン、シリア、北朝鮮**。
*   米国の輸出管理・制裁対象者リストに含まれる個人・団体も参加できません。
*   **主催者（三井物産）およびKaggleの従業員、役員、インターン、契約社員等**はコンペティションに参加可能ですが、**賞金を受け取る資格はありません**。

#### 5.2. チーム編成 (Team Limits)

*   **最大人数:** 1チームあたりの最大人数は**5名**です。
*   **チーム合併:** チーム合併締切日（2025年9月29日）まで可能です。ただし、合併を希望するチームの合計提出回数が、合併時点での1チームあたりの許容最大提出回数（1日の提出上限 × 経過日数）を超えていないことが条件です。

#### 5.3. 提出要件 (Code Requirements)

*   **プラットフォーム:** すべての提出は**Kaggle Notebooks**を介して行う必要があります。
*   **実行時間制限:** ノートブックのコミット（実行）から完了までの時間には、以下の厳しい制限があります。
    *   **トレーニングフェーズ:** CPU・GPUノートブック共に**8時間以内**
    *   **予測フェーズ:** CPU・GPUノートブック共に**9時間以内**
        *   *予測フェーズで実行時間が1時間延長されるのは、テストセットのデータ量が増加することによるタイムアウトのリスクを緩和するためです。しかし、9時間以内に実行を完了させる責任は依然として参加者にあります。*
*   **インターネットアクセス:** セキュリティと再現性の観点から、提出するノートブックからの**インターネットアクセスは無効**化されている必要があります。
*   **提出回数:** 1日（UTC基準）あたりの提出回数は最大**5回**です。
*   **最終提出選択:** コンペティション終了後、最終的な評価対象として、自身が提出したノートブックの中から最大**2つ**までを選択できます。

#### 5.4. 外部データの利用 (External Data)

*   **利用許可:** コンペティションで提供されるデータ以外の外部データ（External Data）を利用してモデルを開発することは**許可**されています。
*   **利用条件:** ただし、その外部データが以下の条件を満たす必要があります。
    1.  **公開性:** 全ての参加者がアクセス可能であること。
    2.  **アクセスの平等性:** 全ての参加者が、本コンペティションの目的のために**無料**で、または**「妥当なコスト（Reasonable Cost）」**で、同等に利用できること。
*   **「妥当性」の基準:** 主催者は、「妥当性」について独自の基準（Reasonableness Standard）を適用します。コストが「過剰」であるか否かを判断し、特定の参加者が不利益を被らないようにします。
    *   **例（許容されるケース）:** Gemini Advancedのような大規模言語モデルの追加機能を利用するための少額のサブスクリプション料金。
    *   **例（許容されないケース）:** コンペティションの賞金額を上回るような高額なライセンス料が必要な、プロプライエタリなデータセットの購入。

#### 5.5. 自動機械学習ツール (AMLT) の利用

*   **利用許可:** Google AutoML, H2O Driverless AIなどの自動機械学習ツール（AMLT）を使用して提出物を作成することは**許可**されています。
*   **利用条件:** ただし、参加者またはチームは、そのAMLTの**適切なライセンスを保持**しており、コンペティションルール（特に後述する受賞者の義務やライセンス許諾）を完全に遵守できることを保証する必要があります。

#### 5.6. コード共有に関する規則

*   **プライベート共有の禁止:** チーム外の参加者と、コンペティションに関連するコードやデータを私的に共有することは**固く禁じられています**。これには、別チーム間でのコード共有も含まれます。このルールへの違反は、失格を含む厳しい措置の対象となります。
*   **パブリック共有の推奨:** コードを共有する場合は、Kaggleのコンペティション専用ディスカッションフォーラムや公開ノートブックなど、**すべての参加者が利益を得られる公開の場**で行う必要があります。
*   **公開共有時のライセンス:** 公開の場でコードを共有した場合、そのコードは、**商用利用を制限しない**オープンソース・イニシアティブ（OSI）承認ライセンス（例: MIT, Apache 2.0など）の下で許諾されたものとみなされます。

#### 5.7. 受賞者の義務とライセンス (Winner's Obligations & License)

賞金を受け取る資格を得た受賞者は、以下の重要な義務を負います。

*   **① コードの提出義務:**
    *   受賞者は、最終的な予測（Winning Submission）を生成した**完全なソフトウェアコード一式**と、その**関連ドキュメント**を主催者（三井物産）に提出する義務があります。
    *   提出物には、**学習コード、推論コード**、そしてコードをビルド・実行するために必要な計算環境（ライブラリのバージョン等）を記述した説明が含まれている必要があります。
    *   要するに、主催者が受賞者のソリューションを**完全に再現できる**状態で提供する必要があります。

*   **② ライセンスの付与:**
    *   受賞者は、提出した受賞作品（ソースコード、モデル、ドキュメントを含む）について、主催者（三井物産）とその指定者に対し、以下の権利を付与することに同意する必要があります。
    *   **ライセンスの種類:** **非独占的ライセンス (Non-Exclusive License)**
    *   **権利の内容:** 世界的、サブライセンス可能、譲渡可能、ロイヤリティフリー、永久、取消不能の権利。これにより、主催者は受賞作品を、**商業利用を含むあらゆる目的**で、自由に利用、複製、配布、派生物作成、販売等を行うことができます。
    *   *（補足：非独占的であるため、受賞者自身もそのコードを他の目的で利用する権利を保持します。）*

*   **③ 詳細なドキュメンテーション:**
    *   主催者の要求に応じて、受賞した提出物がどのように生成されたかについての**詳細な説明書**を提供する義務があります。
    *   これには、モデルのアーキテクチャ、データの前処理手法、損失関数、学習の詳細、使用したハイパーパラメータなど、第三者がそのアプローチを読んで再現できるレベルの詳細な説明が含まれます。